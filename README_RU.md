<p align="center">
  <img src="https://img.shields.io/badge/A4AD-Auth%20Service-007396?style=for-the-badge&logo=openjdk&logoColor=white" alt="A4AD Auth Service">
</p>

<p align="center">
  <img src="https://img.shields.io/badge/Java-21-007396?style=flat-square&logo=openjdk&logoColor=white" alt="Java">
  <img src="https://img.shields.io/badge/Spring%20Boot-3.3+-6DB33F?style=flat-square&logo=springboot&logoColor=white" alt="Spring Boot">
  <img src="https://img.shields.io/badge/PostgreSQL-16+-4169E1?style=flat-square&logo=postgresql&logoColor=white" alt="PostgreSQL">
  <img src="https://img.shields.io/badge/License-MIT-green?style=flat-square" alt="License">
  <img src="https://img.shields.io/badge/Status-Early%20Development-orange?style=flat-square" alt="Status">
</p>

---

## üìù –û–ø–∏—Å–∞–Ω–∏–µ

**Auth Service** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –¥–æ—Å—Ç—É–ø–æ–º (IAM) –¥–ª—è —Ñ–æ—Ä—É–º–∞ A4AD. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π (RBAC) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–æ–ª–µ–π user, moderator –∏ admin.

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üë§ **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π email
- üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –í—Ö–æ–¥ —Å JWT access –∏ refresh —Ç–æ–∫–µ–Ω–∞–º–∏
- üé´ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏** ‚Äî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access-—Ç–æ–∫–µ–Ω–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- üë• **–†–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø** ‚Äî –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Ä–æ–ª–∏: user, moderator, admin
- üîë **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** ‚Äî –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞
- üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π BCrypt, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞—â–∏—Ç–∞ –æ—Ç brute-force
- üìä **–ê—É–¥–∏—Ç** ‚Äî –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üîÑ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏** ‚Äî –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–∑—ã–≤–∞

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫:** Java 21 (LTS)
- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** Spring Boot 3.3+
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** Spring Security 6 + OAuth2 Resource Server
- **JWT:** –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ jjwt –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL 16+
- **ORM:** Spring Data JPA + Hibernate
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** Liquibase –∏–ª–∏ Flyway
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** Jakarta Bean Validation
- **–°–±–æ—Ä–∫–∞:** Maven

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart LR
    Gateway["API Gateway<br/>Go + Fiber"] --> Auth["Auth Service<br/>Java + Spring Boot"]
    Auth --> PostgreSQL[("PostgreSQL<br/>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –¢–æ–∫–µ–Ω—ã, –†–æ–ª–∏")]
    Auth --> Redis[("Redis<br/>–ß—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤")]
    
    subgraph "JWT Flow"
        Client["–ö–ª–∏–µ–Ω—Ç"] -->|"1. –í—Ö–æ–¥"| Auth
        Auth -->|"2. –í—ã–¥–∞—á–∞ JWT"| Client
        Client -->|"3. –ó–∞–ø—Ä–æ—Å + JWT"| Gateway
        Gateway -->|"4. –í–∞–ª–∏–¥–∞—Ü–∏—è JWT"| Auth
    end
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 21 –∏–ª–∏ –≤—ã—à–µ
- Maven 3.9+
- PostgreSQL 16+
- Docker & Docker Compose (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
   ```bash
   git clone https://github.com/A4AD-team/auth-service.git
   cd auth-service
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   mvn clean install
   ```

3. **–ó–∞–ø—É—Å–∫ PostgreSQL:**
   ```bash
   docker compose up -d postgres
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ë–î –∏ JWT-—Å–µ–∫—Ä–µ—Ç–∞–º–∏
   ```

5. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:**
   ```bash
   mvn liquibase:update
   ```

6. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:**
   ```bash
   # –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   mvn spring-boot:run -Dspring.profiles.active=local
   
   # –ò–ª–∏ —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
   mvn clean package
   java -jar target/auth-service-0.1.0.jar
   ```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8081`

---

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|------------|----------|----------------------|--------------|
| `SPRING_PROFILES_ACTIVE` | –ê–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å Spring | `local` | –ù–µ—Ç |
| `SERVER_PORT` | –ü–æ—Ä—Ç HTTP-—Å–µ—Ä–≤–µ—Ä–∞ | `8081` | –ù–µ—Ç |
| `SPRING_DATASOURCE_URL` | JDBC URL PostgreSQL | `jdbc:postgresql://localhost:5432/auth_db` | –î–∞ |
| `SPRING_DATASOURCE_USERNAME` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î | `auth_user` | –î–∞ |
| `SPRING_DATASOURCE_PASSWORD` | –ü–∞—Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `` | –î–∞ |
| `JWT_SECRET` | –°–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT (–º–∏–Ω. 256 –±–∏—Ç) | `` | –î–∞ |
| `JWT_ACCESS_TOKEN_EXPIRATION` | TTL access-—Ç–æ–∫–µ–Ω–∞ –≤ –º—Å | `900000` (15 –º–∏–Ω) | –ù–µ—Ç |
| `JWT_REFRESH_TOKEN_EXPIRATION` | TTL refresh-—Ç–æ–∫–µ–Ω–∞ –≤ –º—Å | `604800000` (7 –¥–Ω–µ–π) | –ù–µ—Ç |
| `REDIS_HOST` | –•–æ—Å—Ç Redis | `localhost` | –î–∞ |
| `REDIS_PORT` | –ü–æ—Ä—Ç Redis | `6379` | –ù–µ—Ç |
| `REDIS_PASSWORD` | –ü–∞—Ä–æ–ª—å Redis | `` | –ù–µ—Ç |
| `MAX_LOGIN_ATTEMPTS` | –ù–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ –¥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | `5` | –ù–µ—Ç |
| `LOCKOUT_DURATION_MINUTES` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ | `30` | –ù–µ—Ç |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `INFO` | –ù–µ—Ç |

---

## üì° –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|------|----------|----------------------|
| `POST` | `/api/v1/auth/sign-up` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ù–µ—Ç |
| `POST` | `/api/v1/auth/sign-in` | –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ù–µ—Ç |
| `POST` | `/api/v1/auth/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access-—Ç–æ–∫–µ–Ω–∞ | –ù–µ—Ç |
| `POST` | `/api/v1/auth/sign-out` | –í—ã—Ö–æ–¥ (–∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞) | –î–∞ |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|------|----------|----------------------|
| `GET` | `/api/v1/users/me` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ | –î–∞ |
| `PATCH` | `/api/v1/users/me` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –î–∞ |
| `DELETE` | `/api/v1/users/me` | –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ | –î–∞ |
| `GET` | `/api/v1/users/:id` | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (—Ç–æ–ª—å–∫–æ admin) | –î–∞ + Admin |
| `GET` | `/api/v1/users` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ admin) | –î–∞ + Admin |

### –†–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|------|----------|----------------------|
| `GET` | `/api/v1/roles` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–æ–ª–µ–π | –î–∞ |
| `GET` | `/api/v1/roles/:id` | –î–µ—Ç–∞–ª–∏ —Ä–æ–ª–∏ | –î–∞ |
| `POST` | `/api/v1/roles` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–æ–ª—å | –î–∞ + Admin |
| `POST` | `/api/v1/users/:id/roles` | –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é | –î–∞ + Admin |
| `DELETE` | `/api/v1/users/:id/roles/:roleId` | –£–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –î–∞ + Admin |

---

## ü©∫ Health Checks

Spring Boot Actuator –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç health-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/actuator/health` | `GET` | –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–¥–æ—Ä–æ–≤—å—è |
| `/actuator/health/liveness` | `GET` | Liveness-–ø—Ä–æ–±–∞ –¥–ª—è Kubernetes |
| `/actuator/health/readiness` | `GET` | Readiness-–ø—Ä–æ–±–∞ |
| `/actuator/info` | `GET` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ |
| `/actuator/metrics` | `GET` | –ú–µ—Ç—Ä–∏–∫–∏ Prometheus |

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "status": "UP",
  "components": {
    "database": {
      "status": "UP"
    },
    "diskSpace": {
      "status": "UP"
    },
    "redis": {
      "status": "UP"
    }
  }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
mvn test

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
mvn clean test jacoco:report

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Ç–µ—Å—Ç–æ–≤
mvn test -Dtest=AuthServiceTest

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Ç–µ—Å—Ç–∞
mvn test -Dtest=AuthServiceTest#testLoginSuccess

# –ü—Ä–æ–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
mvn clean install -DskipTests
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

---

<p align="center">
  <strong>–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –∫–æ–º–∞–Ω–¥–æ–π A4AD</strong>
</p>
